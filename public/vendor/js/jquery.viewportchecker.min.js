(function(a){a.fn.viewportChecker=function(b){var d={classToAdd:"visible",classToRemove:"invisible",classToAddForFullView:"full-visible",removeClassAfterAnimation:false,offset:100,repeat:false,invertBottomOffset:true,callbackFunction:function(g,h){},scrollHorizontal:false,scrollBox:window};a.extend(d,b);var c=this,f={height:a(d.scrollBox).height(),width:a(d.scrollBox).width()},e=((navigator.userAgent.toLowerCase().indexOf("webkit")!=-1||navigator.userAgent.toLowerCase().indexOf("windows phone")!=-1)?"body":"html");this.checkElements=function(){var h,g;if(!d.scrollHorizontal){h=a(e).scrollTop();g=(h+f.height)}else{h=a(e).scrollLeft();g=(h+f.width)}c.each(function(){var o=a(this),k={},n={};if(o.data("vp-add-class")){n.classToAdd=o.data("vp-add-class")}if(o.data("vp-remove-class")){n.classToRemove=o.data("vp-remove-class")}if(o.data("vp-add-class-full-view")){n.classToAddForFullView=o.data("vp-add-class-full-view")}if(o.data("vp-keep-add-class")){n.removeClassAfterAnimation=o.data("vp-remove-after-animation")}if(o.data("vp-offset")){n.offset=o.data("vp-offset")}if(o.data("vp-repeat")){n.repeat=o.data("vp-repeat")}if(o.data("vp-scrollHorizontal")){n.scrollHorizontal=o.data("vp-scrollHorizontal")}if(o.data("vp-invertBottomOffset")){n.scrollHorizontal=o.data("vp-invertBottomOffset")}a.extend(k,d);a.extend(k,n);if(o.data("vp-animated")&&!k.repeat){return}if(String(k.offset).indexOf("%")>0){k.offset=(parseInt(k.offset)/100)*f.height}var m=(!k.scrollHorizontal)?o.offset().top:o.offset().left,i=(!k.scrollHorizontal)?m+o.height():m+o.width();var l=Math.round(m)+k.offset,j=(!k.scrollHorizontal)?l+o.height():l+o.width();if(k.invertBottomOffset){j-=(k.offset*2)}if((l<g)&&(j>h)){o.removeClass(k.classToRemove);o.addClass(k.classToAdd);k.callbackFunction(o,"add");if(i<=g&&m>=h){o.addClass(k.classToAddForFullView)}else{o.removeClass(k.classToAddForFullView)}o.data("vp-animated",true);if(k.removeClassAfterAnimation){o.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){o.removeClass(k.classToAdd)})}}else{if(o.hasClass(k.classToAdd)&&(k.repeat)){o.removeClass(k.classToAdd+" "+k.classToAddForFullView);k.callbackFunction(o,"remove");o.data("vp-animated",false)}}})};if("ontouchstart" in window||"onmsgesturechange" in window){a(document).bind("touchmove MSPointerMove pointermove",this.checkElements)}a(d.scrollBox).bind("load scroll",this.checkElements);a(window).resize(function(g){f={height:a(d.scrollBox).height(),width:a(d.scrollBox).width()};c.checkElements()});this.checkElements();return this}})(jQuery);